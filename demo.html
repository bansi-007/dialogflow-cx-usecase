<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Library Assistant - Dialogflow CX Demo</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
            padding-right: 370px;
        }

        .container {
            background: white;
            border-radius: 15px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.2);
            max-width: 1000px;
            padding: 40px;
            margin: 0 auto;
        }

        h1 {
            color: #667eea;
            font-size: 2.2em;
            margin-bottom: 10px;
            text-align: center;
        }

        .subtitle {
            color: #666;
            text-align: center;
            margin-bottom: 30px;
        }

        .credentials {
            background: #fff3cd;
            border: 2px solid #ffc107;
            padding: 15px;
            border-radius: 8px;
            margin: 20px 0;
            text-align: center;
        }

        .credentials strong {
            color: #856404;
            font-family: monospace;
            font-size: 1.1em;
        }

        .reset-btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 12px 30px;
            border: none;
            border-radius: 8px;
            font-size: 1em;
            font-weight: 600;
            cursor: pointer;
            margin: 20px auto;
            display: block;
            transition: transform 0.2s;
        }

        .reset-btn:hover {
            transform: scale(1.05);
        }

        .section {
            margin: 25px 0;
            padding: 20px;
            background: #f8f9fa;
            border-radius: 10px;
            border-left: 4px solid #667eea;
        }

        .section h2 {
            color: #667eea;
            font-size: 1.4em;
            margin-bottom: 15px;
        }

        .section h3 {
            color: #555;
            font-size: 1.1em;
            margin: 15px 0 10px 0;
        }

        ul {
            margin-left: 20px;
            line-height: 1.8;
        }

        li {
            color: #555;
            margin: 5px 0;
        }

        code {
            background: #e9ecef;
            padding: 2px 6px;
            border-radius: 4px;
            font-family: 'Courier New', monospace;
            color: #d63384;
        }

        .demo-flow {
            background: white;
            padding: 15px;
            margin: 10px 0;
            border-radius: 8px;
            border-left: 3px solid #667eea;
        }

        .demo-flow strong {
            color: #667eea;
        }

        .grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 15px;
            margin: 15px 0;
        }

        .card {
            background: white;
            padding: 15px;
            border-radius: 8px;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }

        .card h4 {
            color: #667eea;
            margin-bottom: 8px;
        }

        @media (max-width: 768px) {
            body {
                padding-right: 20px;
            }

            .container {
                padding: 25px;
            }
        }
    </style>
</head>

<body>
    <div class="container">
        <h1>ðŸ“š Library Assistant</h1>
        <p class="subtitle">Dialogflow CX Conversational AI Demo</p>

        <div class="credentials">
            <strong>Demo Login:</strong> user123 / secretpass
        </div>

        <button class="reset-btn" onclick="resetChat()">ðŸ”„ Reset Chat (Start Fresh)</button>

        <script>
            function resetChat() {
                // Clear browser storage to reset Dialogflow session
                localStorage.clear();
                sessionStorage.clear();
                // Reload page
                window.location.href = window.location.pathname + '?t=' + new Date().getTime();
            }
        </script>

        <!-- ARCHITECTURE -->
        <div class="section">
            <h2>System Architecture</h2>
            <ul>
                <li><strong>Frontend:</strong> Dialogflow Messenger Widget</li>
                <li><strong>AI Engine:</strong> Dialogflow CX (5 Flows, 15+ Intents, 30+ Routes)</li>
                <li><strong>Backend:</strong> Google Cloud Functions (Python 3.11)</li>
                <li><strong>Database:</strong> Mock Library API (10+ books)</li>
            </ul>
        </div>

        <!-- FLOWS -->
        <div class="section">
            <h2>Dialogflow CX Flows</h2>

            <h3>1. Book Search Flow</h3>
            <ul>
                <li><strong>Intents:</strong> SearchBooks, FindBook, PlaceHold</li>
                <li><strong>Entities:</strong> @BookTitle, @Author, @Genre, @ISBN</li>
                <li><strong>Webhook:</strong> book-search (filters catalog)</li>
            </ul>

            <h3>2. Authentication Flow</h3>
            <ul>
                <li><strong>Pages:</strong> Login Form (collects user_id, password)</li>
                <li><strong>Webhook:</strong> auth-webhook (validates credentials)</li>
                <li><strong>Feature:</strong> Smart Resume (auto-completes pending actions)</li>
            </ul>

            <h3>3. Account Management Flow</h3>
            <ul>
                <li><strong>Pages:</strong> View Checkouts, Renew Book, Current Fines</li>
                <li><strong>Intents:</strong> ViewCheckouts, RenewBook, ManageFines</li>
                <li><strong>Webhooks:</strong> account-checkouts, account-renew, account-fines</li>
                <li><strong>Security:</strong> All pages check authentication</li>
            </ul>
        </div>

        <!-- KEY FEATURES -->
        <div class="section">
            <h2>Key Features</h2>
            <div class="grid">
                <div class="card">
                    <h4>Smart Search</h4>
                    <ul>
                        <li>Multi-field filtering</li>
                        <li>Case-insensitive</li>
                        <li>Rich card results</li>
                    </ul>
                </div>
                <div class="card">
                    <h4>Smart Resume</h4>
                    <ul>
                        <li>Saves user intent</li>
                        <li>Auto-executes after login</li>
                        <li>Seamless UX</li>
                    </ul>
                </div>
                <div class="card">
                    <h4>Secure Auth</h4>
                    <ul>
                        <li>Session management</li>
                        <li>Auto-redirects</li>
                        <li>Context preservation</li>
                    </ul>
                </div>
            </div>
        </div>

        <!-- DEMO SCRIPT -->
        <div class="section">
            <h2>ðŸŽ¬ Presentation Demo Script</h2>
            <p style="color: #666; margin-bottom: 15px;"><em>Follow these steps exactly during your presentation:</em>
            </p>

            <div class="demo-flow">
                <strong>DEMO 1: Public Book Search</strong><br><br>

                <strong>Step 1:</strong> Type: <code>Hello</code><br>
                â†’ Agent greets you with welcome message<br><br>

                <strong>Step 2:</strong> Type: <code>Search for Harry Potter</code><br>
                â†’ Agent shows 2 Harry Potter books in a list<br>
                â†’ Explain: "Notice the rich card format with book details"<br><br>

                <strong>Step 3:</strong> Type: <code>Search for Python programming</code><br>
                â†’ Agent shows "Python Crash Course" book<br>
                â†’ Explain: "The search filters our catalog by title, author, or genre"
            </div>

            <div class="demo-flow">
                <strong>DEMO 2: Smart Resume (â˜… Key Feature)</strong><br><br>

                <strong>Step 1:</strong> Type: <code>Place a hold on Harry Potter and the Chamber of Secrets</code><br>
                â†’ Agent says: "I need to verify your account. Please log in."<br>
                â†’ Explain: "This action requires authentication, so the agent redirects to login"<br><br>

                <strong>Step 2:</strong> Type: <code>user123</code><br>
                â†’ Agent asks for password<br><br>

                <strong>Step 3:</strong> Type: <code>secretpass</code><br>
                â†’ Agent says: "Welcome back, John Doe! Successfully placed a hold on 'Harry Potter'..."<br>
                â†’ <strong>Explain:</strong> "Notice the agent automatically completed my hold request! I didn't have to
                say 'place hold' again. This is the Smart Resume feature - it remembered my intent before login and
                auto-executed it after authentication."
            </div>

            <div class="demo-flow">
                <strong>DEMO 3: Account Management</strong><br><br>

                <strong>Step 1:</strong> Refresh the page (to reset session)<br><br>

                <strong>Step 2:</strong> Type: <code>Login</code><br>
                â†’ Agent asks for Member ID<br><br>

                <strong>Step 3:</strong> Type: <code>user123</code><br>
                â†’ Agent asks for password<br><br>

                <strong>Step 4:</strong> Type: <code>secretpass</code><br>
                â†’ Agent shows account dashboard with details<br>
                â†’ Explain: "User is now authenticated"<br><br>

                <strong>Step 5:</strong> Type: <code>View my checkouts</code><br>
                â†’ Agent shows "The Great Gatsby" with due date<br>
                â†’ Explain: "This shows books currently borrowed"<br><br>

                <strong>Step 6:</strong> Type: <code>Renew The Great Gatsby</code><br>
                â†’ Agent says: "Successfully renewed... New due date: [date]"<br>
                â†’ Explain: "The webhook processed the renewal and extended the due date"<br><br>

                <strong>Step 7:</strong> Type: <code>Check my fines</code><br>
                â†’ Agent shows fine status<br>
                â†’ Explain: "All account features are now accessible"
            </div>
        </div>

        <!-- TECHNICAL IMPLEMENTATION -->
        <div class="section">
            <h2>Technical Implementation</h2>

            <h3>Webhook Routing (Tag-Based)</h3>
            <ul>
                <li><code>book-search</code> â†’ Search catalog with filtering</li>
                <li><code>auth-webhook</code> â†’ Authenticate user</li>
                <li><code>account-checkouts</code> â†’ List borrowed books</li>
                <li><code>account-renew</code> â†’ Renew checkout</li>
                <li><code>account-holds</code> â†’ Place/view holds</li>
                <li><code>account-fines</code> â†’ View fines</li>
            </ul>

            <h3>Smart Resume Logic</h3>
            <ul>
                <li>Webhook saves <code>pending_tag</code> before login redirect</li>
                <li>After authentication, checks for pending action</li>
                <li>Auto-dispatches to original handler with saved context</li>
                <li>User never has to repeat their request</li>
            </ul>

            <h3>Response Types</h3>
            <ul>
                <li><strong>Cards:</strong> Book details, account dashboard</li>
                <li><strong>Lists:</strong> Search results, checkouts</li>
                <li><strong>Chips:</strong> Quick reply suggestions</li>
            </ul>
        </div>

        <!-- METRICS -->
        <div class="section">
            <h2>Project Metrics</h2>
            <div class="grid">
                <div class="card">
                    <h4>Dialogflow CX</h4>
                    <ul>
                        <li>5 Flows</li>
                        <li>15+ Intents</li>
                        <li>10+ Entities</li>
                        <li>30+ Routes</li>
                    </ul>
                </div>
                <div class="card">
                    <h4>Backend</h4>
                    <ul>
                        <li>7 Webhook Tags</li>
                        <li>Python 3.11</li>
                        <li>Cloud Functions</li>
                        <li>Serverless</li>
                    </ul>
                </div>
                <div class="card">
                    <h4>Data</h4>
                    <ul>
                        <li>10+ Books</li>
                        <li>Mock Users</li>
                        <li>Sample Checkouts</li>
                        <li>API Ready</li>
                    </ul>
                </div>
            </div>
        </div>

    </div>

    <!-- Dialogflow Messenger Widget -->
    <link rel="stylesheet"
        href="https://www.gstatic.com/dialogflow-console/fast/df-messenger/prod/v1/themes/df-messenger-default.css">
    <script src="https://www.gstatic.com/dialogflow-console/fast/df-messenger/prod/v1/df-messenger.js"></script>
    <df-messenger location="us-central1" project-id="dialogflow-480615" agent-id="f4017d5c-2622-4913-bc21-109c63edd3cf"
        language-code="en" max-query-length="-1" storage="none">
        <df-messenger-chat chat-title="Library Assistant 2"></df-messenger-chat>
    </df-messenger>

    <style>
        df-messenger {
            z-index: 999;
            position: fixed;
            --df-messenger-font-color: #000;
            --df-messenger-font-family: Google Sans;
            --df-messenger-chat-background: #f3f6fc;
            --df-messenger-message-user-background: #d3e3fd;
            --df-messenger-message-bot-background: #fff;
            bottom: 0;
            right: 0;
            top: 0;
            width: 350px;
        }
    </style>
</body>

</html>